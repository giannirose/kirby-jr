Title: Expenditures

----

Layout: [{"attrs":[],"columns":[{"blocks":[{"content":{"text":"### The Expenditures spreadsheet\n\nThe Expenditures page answers the question \"How much will we spend each year on reserves items?\"\n\nThis sum of each year is entered on the Cash Flow page and is an important figure when calculating the amount left in the reserves in any given year."},"id":"47180698-3c4f-4845-a2c0-369a1b682f20","isHidden":false,"type":"markdown"}],"id":"23b99706-a774-4a31-8271-c1f749dd10b2","width":"1/1"}],"id":"8581c739-9de1-4488-a7c0-0ebf8bec1b87"},{"attrs":[],"columns":[{"blocks":[{"content":{"location":"kirby","image":["file://s4WcW9JeBKNFuQyy"],"src":"","alt":"","caption":"","link":"","ratio":"","crop":"false"},"id":"537fdb5a-9d00-47f5-a441-ae9b0c70671b","isHidden":false,"type":"image"}],"id":"58c28444-f03f-4dbe-b333-b93ac6637487","width":"1/1"}],"id":"91525088-b0ed-4080-b3de-07fd5ddcfcde"},{"attrs":[],"columns":[{"blocks":[{"content":{"text":"#### Calculate expenditures in the current year\n\nWe use the same organization of items in categories as on the Categorized Categories page.\n\nIn cell A2 we write:\n```\n='Categorized Components'!A2\n```\nAnd then drag that down the first column to fill in all the Categorized Components listings.\n\nWhen we set up the Categorized Components spreadsheet, we had to carefully arrange which row was refering to which row on the Original Components spreadsheet. For this page, we are refering to the Categorized Components page, so we are back to the more simple practice of, for example, the third row refering to the third row, the fourth row to the fourth, and so on. \n\nTo set up the column headings we begin with the current planning year and extend this row until it matches the 30 years of our study. These years- column head years- are used in our formulas.\n\nIn each of those columns we calculate the Current Cost for any given item in any given year. But we want to show only those years when servicing any given item is scheduled to occur.\n\nTo calculate the current cost the formula is:\n\n```\n'Categorized Component'!Current Cost * (1 + Inflation Rate) ^ (Column Head Year - Parameters!Current Planning Year)\n```\nThe first instance looks like this:\n```\n'Categorized Components'!$E3*(1+Parameters!$C$2)^(B$1-Parameters!$C$5)\n```\nWhen we drag this formula horizontally, all the cells will fill in the Current Cost for the year at the head of the column across the 30 years of the study. \n\nAll of those numbers are accurate, but we want those items to appear on the page only in their service year. \n\nTo do this, we subtract the planning year from whatever year is at the column head and divide that by the Useful Life. We check if there is a remainder or if there is no remainder. We are employing the modulus or (link: https://support.microsoft.com/en-us/office/mod-function-9b6cd169-b6ee-406a-a97b-edf2a9dc24f3 text:MOD()function).\n\nWriting just that part of the formula \n```\n=MOD(B$1-'Categorized Components'!$D3,'Categorized Components'!$F3)=0\n```\nReturns FALSE. The formula is checking if the remainder is 0. The actual numbers being calculated are:\n```\n(2024-2026) / 10 = -.2\n```\nThe remainder is not 0. For that first row, when we get to the first replacement year of 2026, the result will be 0 and the simple Modulus formula will return TRUE. Since each year has a different useful life, results will vary row to row.\n\nWhen that first item is calculated in the column with heading 2026 which, for that item, is the Replacement Year the numbers look like this:\n```\n(2026 - 2026 / 10) = 0\n```\nLikewise, in 2036, with the Useful Life at 10, the result will be <code>10 / 10</code> and once again we get no remainder- the modulus is 0.\n\nWhen we put this together in the larger formula for calculating an actual value, we want the formula to run when the modulus is 0, otherwise we want the cell left blank, which in Excel is achieved with double quotes <code>\"\"</code>.\n\nWe write the formula to run only when the modulus is 0 and otherwise to leave a blank cell.\n```\n=IF(MOD(B$1-'Categorized Components'!$D10,'Categorized Components'!$F10)=0,'Categorized Components'!$E10*(1+Parameters!$C$2)^(B$1-Parameters!$C$5), \"\")\n```\nThe page is arranged in categories and there is space for summing each category, a title row for each category, and a blank space in between for readability. If the full formula is dragged across these cells, we'll get an error in those cells we want blank. To mitigate this, we wrap the IF() statement in an IFERROR() function and leave the cell blank when the error condition is met.\n\nThis is the formula used throughout the page down to the last named item:\n```\n=IFERROR(IF(MOD(B$1-'Categorized Components'!$D3,'Categorized Components'!$F3)=0,'Categorized Components'!$E3*(1+Parameters!$C$2)^(B$1-Parameters!$C$5), \"\"), \"\")\n```\n\nThat formula can be dragged down the Column B. With all those cells highlighted, the can be dragged horizontally across the 30-year span of the study and we'll have the years filled in in their service years.\n\nThat last part of the formula, the <code>\"\"</code>, could be set to enter 0. In fact, it can enter anything placed as part of the final statement of the formula.\n\nWere we to set it to 0, when the modulus calculation is FALSE we'd get a 0 in the cell. We might want to see that to confirm the cells that should run an error are doing so.\n\nThat will leave us with a lot of 0's on the pageâ€”not so great looking."},"id":"391a7f6c-e710-4f2d-91cf-a8222e8241a1","isHidden":false,"type":"markdown"}],"id":"a70eb369-885b-4974-9b7d-cdca7fe9287d","width":"1/1"}],"id":"22d379bf-8a56-4b2d-a7b7-7c49a0b72552"},{"attrs":[],"columns":[{"blocks":[{"content":{"text":"#### Hide zero values\n\nIn Excel Preferences, there is a \"View\" option where one can check/leave unchecked a box to show/hide zero values.\n\nOnce a formula is set up for a whole page, one can check this box to confirm that zero values show up where expected.\n\nAt that point one can choose not to show zero values or, as I did in the formula with the double quotes, to enter nothing in those cells."},"id":"4098ffd8-5e70-402e-8e2a-cd578b52da4e","isHidden":false,"type":"markdown"}],"id":"fda15d65-00cc-45a4-8bab-19d6d3fc6586","width":"1/2"},{"blocks":[{"content":{"location":"kirby","image":["file://ElnGUq0KSWLZbd9P"],"src":"","alt":"","caption":"","link":"","ratio":"","crop":"false"},"id":"cd048448-69fa-4a6c-a055-431c4fc7e01b","isHidden":false,"type":"image"}],"id":"ab5adf22-4765-49df-b112-3f57f4955580","width":"1/2"}],"id":"139cc1a8-2209-423c-93ff-7c1862903af5"},{"attrs":[],"columns":[{"blocks":[{"content":{"location":"kirby","image":["file://S6gge5FAEbwdwv3Y"],"src":"","alt":"","caption":"","link":"","ratio":"","crop":"false"},"id":"6ce988c3-20e9-4087-a84a-2ccd81e88071","isHidden":false,"type":"image"}],"id":"27dc70b1-9e9e-4a2c-add9-de09ac43e2f7","width":"1/2"},{"blocks":[{"content":{"text":"What we ultimately want are the totals for each year. These totals will be used on our Cash Flow page.\n\nThe image shows a few columns at the bottom of our spreadsheet. The Totals row uses the SUM() function, <code>SUM(B1:B127)</code> in the first instance, and this can be dragged across the row to total each column. \n\nIn these examples I have not entered totals for each category. I left the space to do so, but I have no particular need for them.\n\nWere we to do so, we would re-write the SUM() function to add just the individual items, and then we'd have the opportunity to sum the category totals as well. They should agree, so this might be a useful check."},"id":"ddb81432-1f29-4681-8308-dfff829c93e5","isHidden":false,"type":"markdown"}],"id":"6a940a5f-bfae-41da-bdf8-67d0280a8c18","width":"1/2"}],"id":"17b4bd67-ce77-4d3a-9b79-aff1e3bac665"},{"attrs":[],"columns":[{"blocks":[{"content":{"text":"The Expenditures page makes it easy to see what is planned for any given year. Should one want to make changes, we do that on the Original Components page and those changes ripple through the Categorized Components and then onto this page."},"id":"48856b3d-4baa-4608-8c6b-bd934e97dc52","isHidden":false,"type":"markdown"}],"id":"7ff7d35e-a78d-407f-b3fe-afb5d024c2b1","width":"1/1"}],"id":"c6edbf09-90e0-4c1c-9056-1a47834e80de"}]

----

Uuid: fhxjLBn2LB0OV9bO